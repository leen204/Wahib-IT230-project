<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book Appointment | Wahib</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="base.css">
</head><body onload="guard('donor')">
<header class="w-header"></header>

<section class="container">
  <h2>Book Appointment</h2>
  <div class="panel" style="max-width:600px;margin:auto">
    <form id="f">
      <label>Hospital</label><input id="h" readonly>
      <label>City</label><input id="c" readonly>
      <label>Blood Type</label><input id="b" readonly>
      <label>Date</label><input id="d" type="date" required>
      <label>Time</label><input id="t" type="time" required>
      <button class="w-btn" type="submit">Save Appointment</button>
    </form>
  </div>
</section>

<footer class="w-footer"></footer>
<div id="w-toast"></div>
<div id="w-confirm"><div class="box">
  <h3 id="w-confirm-title">Confirm</h3><p id="w-confirm-msg">Are you sure?</p>
  <div class="actions"><button class="w-btn secondary" id="w-cancel">Cancel</button><button class="w-btn" id="w-ok">Yes</button></div>
</div></div>
<script src="app.js"></script>
<script src="ui.js"></script>
<script src="footer.js"></script>

<script>
const sel = getSelectedReq();
if(!sel){ location.href='donor_home.html'; }
h.value = sel.hospital; c.value = sel.city; b.value = sel.blood;

document.getElementById('f').addEventListener('submit', async e=>{
  e.preventDefault();
  if(hasActiveAppt()){ toast('You already have an active appointment.','err'); return; }
  const ok = await confirmBox('Confirm booking this appointment?', 'Book');
  if(!ok) return;
  addAppointment({hospital:h.value, city:c.value, blood:b.value, date:d.value, time:t.value, requestId:sel.id});
  toast('Appointment booked successfully.');
  setTimeout(()=> location.href='donor_home.html', 900);
});
</script>

</body></html>
